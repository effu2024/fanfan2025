<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>体检客户随访记录单</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; line-height: 1.5; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; font-size: 24px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #333; padding: 10px; text-align: left; }
        th { background-color: #f5f5f5; font-weight: bold; }
        .btn-container { text-align: center; margin-top: 30px; }
        #exportBtn { 
            padding: 12px 30px; background-color: #27ae60; color: white; 
            border: none; border-radius: 4px; cursor: pointer; font-size: 16px; 
        }
        #exportBtn:hover { background-color: #219653; }
        .form-group { margin-bottom: 15px; }
        label { display: inline-block; width: 120px; font-weight: 500; }
        input, textarea, select { 
            width: calc(100% - 130px); padding: 8px; border: 1px solid #ddd; 
            border-radius: 4px; box-sizing: border-box; 
        }
        textarea { height: 100px; resize: vertical; }
    </style>
</head>
<body>
    <div class="container" id="exportContent">
        <h1>体检客户随访记录单</h1>
        
        <!-- 客户基础信息 -->
        <div class="form-group">
            <label>客户姓名：</label>
            <input type="text" placeholder="请输入客户姓名">
        </div>
        <div class="form-group">
            <label>体检编号：</label>
            <input type="text" placeholder="请输入体检编号">
        </div>
        <div class="form-group">
            <label>联系电话：</label>
            <input type="tel" placeholder="请输入联系电话">
        </div>
        <div class="form-group">
            <label>体检日期：</label>
            <input type="date" placeholder="请选择体检日期">
        </div>
        <div class="form-group">
            <label>随访日期：</label>
            <input type="date" placeholder="请选择随访日期">
        </div>
        <div class="form-group">
            <label>随访方式：</label>
            <select>
                <option value="">请选择</option>
                <option value="电话">电话随访</option>
                <option value="微信">微信随访</option>
                <option value="短信">短信随访</option>
                <option value="上门">上门随访</option>
            </select>
        </div>
        
        <!-- 体检异常指标记录 -->
        <h3 style="color: #2c3e50; margin: 20px 0 10px;">体检异常指标</h3>
        <table>
            <thead>
                <tr>
                    <<th>序号</</th>
                    <<th>异常项目</</th>
                    <<th>检查结果</</th>
                    <<th>参考范围</</th>
                    <<th>风险等级</</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="text" placeholder="如：血压"></td>
                    <td><input type="text" placeholder="如：145/95 mmHg"></td>
                    <td><input type="text" placeholder="如：90-139/60-89 mmHg"></td>
                    <td>
                        <select>
                            <option value="">请选择</option>
                            <option value="低危">低危</option>
                            <option value="中危">中危</option>
                            <option value="高危">高危</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><input type="text" placeholder="如：血糖"></td>
                    <td><input type="text" placeholder="如：6.8 mmol/L"></td>
                    <td><input type="text" placeholder="如：3.9-6.1 mmol/L"></td>
                    <td>
                        <select>
                            <option value="">请选择</option>
                            <option value="低危">低危</option>
                            <option value="中危">中危</option>
                            <option value="高危">高危</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><input type="text" placeholder="如：血脂"></td>
                    <td><input type="text" placeholder="如：5.2 mmol/L"></td>
                    <td><input type="text" placeholder="如：<5.18 mmol/L"></td>
                    <td>
                        <select>
                            <option value="">请选择</option>
                            <option value="低危">低危</option>
                            <option value="中危">中危</option>
                            <option value="高危">高危</option>
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <!-- 随访核心内容 -->
        <div class="form-group">
            <label>客户健康诉求：</label>
            <textarea placeholder="请记录客户当前健康疑问或需求"></textarea>
        </div>
        <div class="form-group">
            <label>随访指导意见：</label>
            <textarea placeholder="请填写饮食、运动、用药等指导建议"></textarea>
        </div>
        <div class="form-group">
            <label>下次随访计划：</label>
            <input type="date" placeholder="请选择下次随访日期">
        </div>
        <div class="form-group">
            <label>随访人员：</label>
            <input type="text" placeholder="请输入随访人员姓名">
        </div>
        <div class="form-group">
            <label>备注：</label>
            <textarea placeholder="其他需记录的信息"></textarea>
        </div>
    </div>

    <div class="btn-container">
        <button id="exportBtn">导出Word文件</button>
    </div>

    <!-- 导出Word依赖库 -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
    <script>
        // 导出Word功能
        document.getElementById('exportBtn').addEventListener('click', function() {
            const content = document.getElementById('exportContent').innerHTML;
            const converted = htmlDocx.asBlob(content, {
                margins: { top: 1, right: 1, bottom: 1, left: 1 }, // 单位：英寸
                orientation: 'portrait' // 纵向排版
            });
            // 文件名默认包含当前日期
            const date = new Date().toLocaleDateString().replace(/\//g, '-');
            saveAs(converted, `体检客户随访记录_${date}.docx`);
        });
    </script>
</body>
</html>
